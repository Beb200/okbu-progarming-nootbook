<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add</title>
</head>

<style> 
table, th, td { 
   border: 2px solid gray; 
} 
</style>

<body>
    <h1>Add</h1>
    <p>Name&nbsp;<input type="text" id="game-name-input-id" value="ow"></text></p>
    <p>Is it a esports game (y/n) <input type="text" id="esports-input-id" value="y"></p>
    <p>Console <input type="text" id="console-input-id" value="pc"></p>
    <p>Genre <input type="text" id="genre-input-id" value="fps"></p>
    <input type="button" id="button-add-id" value="Add Game"><br><br>
    <div id="added-game-id"></div>
    <div id="added-game-table-id"></div>
    <a href="home_page.html"><button type="button">Home</button></a>

</body>

<script>
    let add_button = document.getElementById("button-add-id");
    add_button.addEventListener("click", async function(event){
        console.log("add button clicked");
        let add_name = document.getElementById("game-name-input-id");
        let add_esports = document.getElementById("esports-input-id");
        let add_console = document.getElementById("console-input-id");
        let add_genre = document.getElementById("genre-input-id");

        let add_name_val = add_name.value;
        let add_esports_val = add_esports.value;
        let add_console_val = add_console.value;
        let add_genre_val = add_genre.value;

        console.log(add_name_val);
        console.log(add_esports_val);
        console.log(add_console_val);
        console.log(add_genre_val);

        let response = await fetch("http://localhost:3000/add-game",{
            method : "POST",
            headers: {
                'Accept' : "application/json",
                'Content-Type' : 'application/json'
            },
            body: JSON.stringify({
                name : add_name.value,
                esport : add_esports.value,
                console : add_console.value,
                genre : add_genre.value
            })
    });
    let the_data = await response.json();
    console.log(the_data);
    let game = the_data.game;
    console.log("the added game is:" + game);
    //let name = game["name"];
    //console.log(name);
    let added_game = document.getElementById("added-game-id");
    let show_game = document.createElement("p");
    show_game.textContent = "The added game is: ";
    added_game.appendChild(show_game);

    let added_game_table =document.getElementById("added-game-table-id");
    //show_name = document.createElement("p");
    //show_name.textContent = game.name;
    //added_game_name.appendChild(show_name);
    let table = document.createElement("table");

        let thead = document.createElement("thead");
        let headR = document.createElement("tr");
        let th_name = document.createElement("th");
        th_name.textContent = "Name";
        let th_esport = document.createElement("th");
        th_esport.textContent = "Esports";
        let th_console = document.createElement("th");
        th_console.textContent = "Console";
        let th_genre = document.createElement("th");
        th_genre.textContent = "Genre"
        headR.appendChild(th_name);
        headR.appendChild(th_esport);
        headR.appendChild(th_console);
        headR.appendChild(th_genre);

        table.appendChild(headR);

        let tbody = document.createElement("tbody");
        let bodyR = document.createElement("tr");
        let td_name = document.createElement("td");
        td_name.textContent = game.name;
        let td_esport = document.createElement("td");
        td_esport.textContent = game.esport;
        let td_console = document.createElement("td");
        td_console.textContent = game.console;
        let td_genre = document.createElement("td");
        td_genre.textContent = game.genre;
        bodyR.appendChild(td_name);
        bodyR.appendChild(td_esport);
        bodyR.appendChild(td_console);
        bodyR.appendChild(td_genre);

        table.appendChild(bodyR)

        added_game_table.appendChild(table);
    })
        
        

</script>

</html>